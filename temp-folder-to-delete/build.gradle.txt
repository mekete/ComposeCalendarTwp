apply plugin: 'com.android.application'
apply plugin: 'com.google.firebase.crashlytics'

android {
    compileSdk 36
    //buildToolsVersion '29.0.3'
    def playStoreCode = 97

    //Add git hash and build time to your BuildConfig
    def gitSha = 'git rev-parse --short HEAD'.execute([], project.rootDir).text.trim()
    def buildTime = new Date().format("yyyy-MM-dd HH:mm:ss")
    def appName = "EthioCal"

    def facebookDevIdPrefix = "com.facebook.app.FacebookContentProvider"
    def facebookAppIdRelease = "162772290964771"
    def facebookAppIdDebug = "501867434081414"

    compileOptions {
        sourceCompatibility = JavaVersion.VERSION_17
        targetCompatibility = JavaVersion.VERSION_17
    }
    defaultConfig {
        applicationId "com.shalom.calendar"
        resourceConfigurations += ["am", "en", "fr"]
        minSdkVersion 23
        targetSdkVersion 36
        multiDexEnabled true
        //
        int subVersion = 0
        versionName "2.9.${subVersion}.${playStoreCode}"
        versionCode playStoreCode
        setProperty("archivesBaseName", "${appName}-${versionName}")
        //
        //testInstrumentationRunner "android.support.test.runner.AndroidJUnitRunner"
        vectorDrawables {
            useSupportLibrary = true
        }
        //https://stackoverflow.com/questions/44322178/room-schema-export-directory-is-not-provided-to-the-annotation-processor-so-we
        javaCompileOptions {
            annotationProcessorOptions {
                arguments = ["room.schemaLocation": "$projectDir/schemas".toString()]
            }
        }
        //

        buildConfigField "boolean", "ENABLE_LEAK_CANARY", "false"
        buildConfigField "String", "GIT_SHA", "\"${gitSha}\""
        buildConfigField "String", "BUILD_TIME", "\"${buildTime}\""
        resConfigs 'en', 'am', 'ge', 'fr'
    }


    buildTypes {
        debug {


            applicationIdSuffix '.debug'
            versionNameSuffix '-D'
            resValue "string", "app_name", "Ethio Calendar-D"
            minifyEnabled false
            resValue("string", "facebook_developer_app_id", "${facebookDevIdPrefix}${facebookAppIdDebug}")

            manifestPlaceholders = [contentProviderName     : "com.shalom.calendar.debug.content.ContentProvider",
                                    contentProviderAuthority: "com.shalom.calendar.debug.content.contentprovider",
                                    appId: "com.shalom.calendar.debug",
                                    widgetPreferenceActivity: "com.shalom.calendar.debug.WidgetConfigActivity",
                                    crashlyticsCollectionEnabled: "false"

            ]

            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
        }
        release {
            resValue "string", "app_name", "Ethio Calendar"
            minifyEnabled true
            shrinkResources true
            resValue("string", "facebook_developer_app_id", "${facebookDevIdPrefix}${facebookAppIdRelease}")

            manifestPlaceholders = [contentProviderName     : "com.shalom.calendar.content.ContentProvider",
                                    contentProviderAuthority: "com.shalom.calendar.content.contentprovider",
                                    appId: "com.shalom.calendar",
                                    widgetPreferenceActivity: "com.shalom.calendar.WidgetConfigActivity",
                                    crashlyticsCollectionEnabled: "false"
            ]
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
        }
    }
    packagingOptions {
        resources {
            excludes += ['META-INF/LICENSE.txt', 'META-INF/NOTICE.txt']
        }
    }

    applicationVariants.all {
        variant ->
            variant.outputs.each {
                output -> // apk is output
                    variant.assembleProvider.get().doLast {
                        if (variant.mappingFile != null && variant.mappingFile.exists()) {
                            variant.mappingFile.renameTo(new File("${output.outputFile.parent}/mapping-${defaultConfig.versionName}.txt"));
//                        copy {
//                            from variant.mappingFile
//                            into output.outputFile.parent
//                         }
                        }
                    }
            }
    }


    namespace 'com.shalom.calendar'
    buildFeatures {
        viewBinding = true
        buildConfig = true
    }

    lint {
        baseline = file("lint-baseline.xml")
    }
}

ext {
    googleMaterialLibVersion = "1.0.0"//"""1.0.0-alpha1"
    androidxVersion = "1.0.0"//"1.0.0-rc02"
    constraintLayoutVersion = "2.1.4"
    archComponentsVersion = "1.0.0"
    espressoVersion = "2.2.2"
    androidTestVersion = "0.4"
    hamcrestVersion = "1.3"
    junitVersion = "4.12"
    //
    playServicesVersion = "15.0.0"
    firebaseVersion = "16.0.5"
    firebaseUiVersion = "4.2.0"
    leakCanaryVersion = "1.5.1"
    crashlyticsVersion = "2.9.9"
    // iTextVersion = "5.5.10"
    //

}


dependencies {
    implementation fileTree(include: ['*.jar'], dir: 'libs')
    implementation 'androidx.core:core-splashscreen:1.0.1'

    implementation "androidx.constraintlayout:constraintlayout:2.2.1"
    implementation "com.google.android.material:material:1.13.0"
    implementation 'androidx.multidex:multidex:2.0.1'
    implementation 'com.google.android.play:app-update:2.1.0'
    //
    implementation "androidx.appcompat:appcompat:1.7.1"
    implementation "androidx.appcompat:appcompat-resources:1.7.1"
    //
    implementation "androidx.asynclayoutinflater:asynclayoutinflater:1.1.0"
    implementation "androidx.cardview:cardview:1.0.0"
    implementation "androidx.collection:collection:1.5.0"
    implementation "androidx.coordinatorlayout:coordinatorlayout:1.3.0"
    implementation "androidx.cursoradapter:cursoradapter:1.0.0"
    implementation 'androidx.browser:browser:1.9.0'
    implementation "androidx.customview:customview:1.2.0"
    //
    implementation "androidx.recyclerview:recyclerview-selection:1.2.0"
    implementation 'androidx.recyclerview:recyclerview:1.4.0'
    implementation "androidx.vectordrawable:vectordrawable:1.2.0"
    implementation "androidx.percentlayout:percentlayout:1.0.0"
    implementation "androidx.legacy:legacy-support-v4:1.0.0"

    //
    implementation platform('com.google.firebase:firebase-bom:34.4.0')
    implementation(platform("org.jetbrains.kotlin:kotlin-bom:1.9.25"))
     implementation("com.google.code.gson:gson:2.13.2")
    implementation 'com.google.firebase:firebase-analytics:23.0.0'
    implementation 'com.google.firebase:firebase-firestore:26.0.2'
//18.2.0"//         Cloud Firestore
    implementation 'com.google.firebase:firebase-config:23.0.1'//18.0.0"//
    implementation 'com.google.firebase:firebase-crashlytics:20.0.3'
    implementation 'com.google.firebase:firebase-messaging:25.0.1'
    implementation 'com.google.firebase:firebase-inappmessaging-display:22.0.1'

    //
    implementation 'de.hdodenhof:circleimageview:3.1.0'
    implementation 'com.facebook.android:facebook-android-sdk:18.1.3'
    implementation 'androidx.lifecycle:lifecycle-livedata-ktx:2.9.4'
    implementation 'androidx.lifecycle:lifecycle-viewmodel-ktx:2.9.4'
    implementation 'androidx.navigation:navigation-fragment:2.9.5'
    implementation 'androidx.navigation:navigation-ui:2.9.5'

    // Java language implementation
    implementation "androidx.preference:preference:1.2.1"
    debugImplementation 'com.squareup.leakcanary:leakcanary-android:2.14'

    //
    implementation 'net.danlew:android.joda:2.13.1'
    //todo
    //implementation 'org.threeten:threeten-extra:1.7.2'
    //implementation 'com.jakewharton.threetenabp:threetenabp:1.4.4'


}


apply plugin: 'com.google.gms.google-services'
